<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://mhrons.github.io/pv_smooth/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Smoothing of PV intermitency - Milan Docs</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Smoothing of PV intermitency";
        var mkdocs_page_input_path = "pv_smooth.md";
        var mkdocs_page_url = "/pv_smooth/";
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Milan Docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">About me</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../pv_log/">Photovoltaic intermitency</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../pv_log/#impact-on-the-grid">Impact on the grid</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../pv_log/#measurement-of-global-irradiance">Measurement of global irradiance</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Smoothing of PV intermitency</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#accumulation-of-energy-by-smoothing">Accumulation of energy by smoothing</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#ideal-smoothing-iplpf">Ideal smoothing (IPLPF)</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#smoothing-by-iplpf-vs-lpf">Smoothing by IPLPF vs LPF</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#costs-of-iplpf-smoothing">Costs of IPLPF smoothing</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#conditions-of-cost-calculation">Conditions of cost calculation:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#applications-of-iplpf">Applications of IPLPF</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#small-scale-hybrid-pv-system">Small-scale hybrid PV system</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#suitable-accumulators-for-iplpf">Suitable accumulators for IPLPF</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#large-scale-pv-plant">Large-scale PV plant</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#summary-of-iplpf">Summary of IPLPF</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#real-smoothing-of-pv-power">Real smoothing of PV power</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#simulation-of-predicted-pv-power">Simulation of predicted PV power</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#analysis-by-prediction-error">Analysis by prediction error</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#smoothed-predicted-signal">Smoothed predicted signal</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#random-error-in-predicted-values">Random error in predicted values</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#analysis-by-lpf-order">Analysis by LPF order</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#accumulated-energy-by-smoothing">Accumulated energy by smoothing</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#graphical-display-of-smoothing">Graphical display of smoothing</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#analysis-by-prediction-error_1">Analysis by prediction error</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#day-with-medium-insolation">Day with medium insolation</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#day-with-high-insolation">Day with high insolation</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#analysis-by-lpf-order_1">Analysis by LPF order</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#day-with-medium-insolation_1">Day with medium insolation</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#day-with-high-insolation_1">Day with high insolation</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../v_glossary/">Glossary</a>
    <ul>
    </ul>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Milan Docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Smoothing of PV intermitency</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="smoothing-of-pv-power-intermittency">Smoothing of PV power intermittency</h1>
<p>Energy balancing between the grid and the battery may eliminate the PV intermittency almost loss-free. The objective of a loss-free smoothing is to meet the maximum ramping limits of PV power (allowed by a relevant technical standard) while accumulating the minimum possible energy by the filter. If the smooth PV power is generated by a low-pass filter (LPF) excited by the electrical output of PV panels, such a power filter induces high accumulation costs due to its time lag (group delay in its frequency response). The time lag could be eliminated, if LPF was excited by the future PV power signal. Unfortunately, the short-time PV prediction (nowcasting) is not exact and its error dramatically increases the accumulated energy by the LPF. Recently, various 
<a href="https://www.sciencedirect.com/science/article/abs/pii/S1364032119304459">predictive filters</a>
 (e.g. 
<a href="https://www.planetanalog.com/five-things-to-know-about-prediction-and-negative-delay-filters/">zero group-delay filter</a>
, <a href="https://www.kalmanfilter.net/default.aspx">Kalman filter</a>
, moving average, moving median, etc.) have been developed to avoid the accumulation of PV energy due to the LPF time lag and the nowcasting error. Nevertheless, the accumulation of PV power and its cost induced by the predictive filters still exceed the production cost of e.g. nuclear electricity. The advantage of predictive filters is that they integrate the predictor and LPF into a same entity, but their disadvantage is that the predictor is trained by a limited information carried by the signal GI(t).<br />
We focus our analysis on the application of a 
<a href="https://www.analog.com/en/design-center/glossary/low-pass-filter.html">standard LPF</a>
 excited by a 
<a href="https://www.sciencedirect.com/science/article/abs/pii/S0038092X14001327">PV predictor</a>
  trained by the sky imagery and GI(t) signals:</p>
<figure>
<p><img alt="PLPF Schema" src="../img/Schema_PLPF.png" width="650" />
  </p>
<figcaption>Figure 1: Smoothing of PV power by a low-pass filter</figcaption>
</figure>
<p>In the schematic diagram on Figure 1, PV power plant (PVPP) is connected to the grid and its intermittent PV power p(t) is accumulated or compensated (i.e. smoothed) by the accumulator (BESS). The smoothing power is actuated by a bi-directional inverter AC/DC. It is determined by the ouput signal p(t)-s(t+Δt) of a differencer. Positive sign of the smoothing power is oriented from the grid to BESS. Hence the total power superimposed to the grid by PVPP and BESS is determined by the filter’s output signal s(t+Δt). For the simplification, PVPP and BESS are single-phase-connected to the grid. We will further consider 4 different smoothing methods:</p>
<ul>
<li>
<p>In case of <strong>LPF</strong> smoothing, the measured signal p(t) would bypass the predictor, directly exciting LPF.</p>
</li>
<li>
<p>In theory, ideal predictive smoothing <strong>IPLPF</strong> would excite LPF by the exact future PV power signal p(t+Δt) where the time advance Δt is absolutely equal to the LPF's group delay at frequencies f&lt;&lt;fc, and fc is the cut-off frequency of LPF. The smooth power signal s(t+Δt) would be the response of LPF to the input signal p(t+Δt).</p>
</li>
<li>
<p>According to the schematic diagram, <strong>PLPF</strong> smoothing method excites LPF by a predicted PV power signal pf(t+Δt). Its predictor is trained by the sky-imagery signal and by the measured PV power p(t).</p>
</li>
<li>
<p>Eventually, a smart smoothing method <strong>SPLPF</strong> (patent pending) has been designed, integrating the filter with the PV predictor which is trained by the sky-imagery signal and by the measured PV power p(t). This method uses a modified scheme.</p>
</li>
</ul>
<h2 id="accumulation-of-energy-by-smoothing">Accumulation of energy by smoothing</h2>
<p>For simplicity of analysis, the energy losses in AC/DC conversion and accumulation are neglected.<br />
Time course of the accumulated energy by ESS:</p>
<p>
<script type="math/tex; mode=display">SOC(t)=\int_{0}^t (p(\tau)-s(\tau+\Delta t))d\tau\ \ \ \ \ \ \ \ \ (1)</script>
</p>
<p>defines the change of its state-of-charge [Wh] since time=0 until time=t, while SOC may acquire both positive and negative values. (Always-positive SOC values can be technically managed in ESS.) The time advance Δt reduces absolute values of the integrated function. The above-defined time advance Δt ensures that following technical criteria are satisfied:<br />
Mean value of SOC is near to zero: <script type="math/tex; mode=display">{1 \over T} \int_{0}^T SOC (t) dt ≈ 0\ \ \ \ \ \ \ \ \ (2)</script>
</p>
<p>Mean quadratic deviation of SOC is near to minimum: <script type="math/tex; mode=display">{1 \over T} \int_{0}^T SOC^2 (t) dt ≈ min\ \ \ \ \ \ \ \ \ (3)</script>
</p>
<p>Hence near-to-minimum required accumulaton capacity per cycle: <script type="math/tex; mode=display">\Delta SOC = max(SOC) – min(SOC) ≈ min\ \ \ \ \ \ \ \ \ (4)</script>
</p>
<p>The value ΔSOC should be predicted and ESS must be accordingly pre-charged at the begining of each cycle T (24 hours in case of PV energy) in order to always keep SOC≥0.<br />
Eventually, near-to-minimum throughput of accumulated energy per cycle is achieved by Δt: <script type="math/tex; mode=display">{1 \over 2} \int_{0}^T|p(\tau)-s(\tau+\Delta t)|d \tau ≈ min\ \ \ \ \ \ \ \ \ (5)</script>
</p>
<p>The rate of accumulation is expressed by (4) and (5) which are minimized by Δt during a working cycle T. The rate of accumulation is also expressed by the extreme ESS power demand p(τ)-s(τ+Δt) during a sudden loss or peak of direct sunlight. This value results from the installed power of PVPP.</p>
<p>Let us assume that PV power is proportional to the global solar irradiance GI [W/m2]. In our experiment, the solar irradiance is intercepted by a planar panel 20 cm x 16 cm on the earth’s surface at latitude=48.2°N, longitude=17.1°E, with the plane of incidence elevated by 47°, south-oriented. At this point it should be mentioned that the spectrum of a real PV power is smoother than the spectrum of GI(t), as the surface area of PV plane acts like a moving-average filter. Unfortunately, the size and speed of clouds prevents a true smoothing effect from being achieved. By assuming the proportionality between the PV power p(t) and the global irradiance GI(t), we analyze the worst case of solar intermittency. Let us substitute the signals p(τ), s(τ+Δt) in (1) by the measured signal GI(τ) and by its “predicted-and-smoothed” counterpart GIs(τ+Δt). After substituting, the expression (1) computes the time course of specific accumulated energy GX(t) [Wh/m2] by the filter.</p>
<h2 id="ideal-smoothing-iplpf">Ideal smoothing (IPLPF)</h2>
<p>We simulate the operation of ideal predictive PV smoothing (IPLPF) by means of LPF excited by the exact future signal GI(t+Δt) where GI(t) is measured and the time advance Δt (given by the LPF group delay) eliminates the filter’s time lag. In theory, such a "ex post" simulated smoothing would minimize the accumulation of energy by the filter. This analysis aims to reveal the theoretical potential and affordability of PV smoothing. The numeric experiment is based on the measured solar irradiance over a period of 1 year, assuming contemporary prices of Lithium-Ion accumulators and EDLC supercapacitors.<br />
The measured time series GI(t) eventually allows to calculate the specific accumulator’s capacity [Wh/m2], its specific power [W/m2], specific energy throughput [Wh/m2/day], [Wh/m2/year] requested by the IPLPF smoothing. Based on the accumulators’ specifications and prices in 2021, the corresponding accumulation costs have been calculated. This confirmed that the IPLPF operation is definitely worthwhile with the German power purchase tariff and PV feed-in tariff in 2021. The ideal smoothing costs are substantially lower than the difference between purchase tariff and PV feed-in tariff. (We may assume that the smooth PV infeed partially compensates for the distribution costs.) 
The simulation suggests an affordable smoothing model for a hybrid small-scale PV plant, and suggests the accumulation technology for large-scale PV plants.  </p>
<h3 id="smoothing-by-iplpf-vs-lpf">Smoothing by IPLPF vs LPF</h3>
<p>Global irradiance GI measured (legend meas), filtered by LPF (legend lp) and by IPLPF (legend aavg0), and specific accumulated energy GX:<br />
<img alt="PV Logger" src="../img/GI_PV2.3but7.5.2022-04-04.png" style="width: 49%; align='left';" />
<img alt="PV Logger" src="../img/GX_PV2.3but7.5.2022-04-04.png" style="width: 49%; align='right';" /></p>
<p>The left graph shows the measured and low-passed (legend “lp”) GI signals on a day with high solar exposure and strong intermittency. The graph on the right shows the specific accumulated energy GX [Wh/m2] by IPLPF vs. LPF on the same day. The time course of GX is proportional to the battery's state of charge SOC [Wh]. Exactly-predicted input signal shifts the IPLPF output to the left (legend “aavg0”), minimizing the standard deviation of SOC, thus in practise minimizing the difference ΔSOC = max(SOC) – min(SOC) which is the requested accumulation capacity. The throughput of accumulated energy (other than ΔSOC) is also minimized by IPLPF.</p>
<h3 id="costs-of-iplpf-smoothing">Costs of IPLPF smoothing</h3>
<p>The smoothing costs result from the energy accumulation. Accumulation costs are given by the rate of accumulation and the technology (e.g. Lithium-Ion RedOx, EDLC supercapacitor etc.). In theory, the accumulation rate is given by the intermittency of solar irradiance vs. desired time course of the output PV power. The accumulation rate is quantified by:</p>
<ol>
<li>mandated ESS capacity, i.e. ΔSOC [Wh] reserved for smoothing (4)</li>
<li>total accumulated energy throughput [Wh] by smoothing (5)</li>
<li>maximum power [W] to/from ESS, balancing the intermittent PV power</li>
</ol>
<p>In practice, the values 1. and 2. are larger the more imperfectly the balancing power between the grid and the battery is controlled. In the illustrated example, IPLPF needs only 24% ΔSOC relative to LPF, and IPLPF accumulates about 50% of the energy throughput if compared to LPF. Both ΔSOC and energy throughput reach their theoretical minimum by means of IPLPF smoothing.<br />
The higher LPF order or its lower cut-off frequency, the smoother output, but "earlier" input signal needed to eliminate the filter's time lag. (In case of PLPF smoothing: The greater Δt, the greater prediction error and the greater rate of accumulation.)<br />
The IPLPF simulation has confirmed that a hybrid PV system i.e. a small-scale on-grid PV plant having its own BESS with capacity = 2 hours x Ppvmax, need &lt;10% of the BESS capacity to be reserved for smoothing (7% on 2022-03-04), while the rest BESS capacity is used for the energy storage. The hybrid PV plant feeds its “overflow” power into the grid, as long as the household’s consumption is satisfied and the battery has been charged. <strong><em>Having the reserved free capacity and total battery power available, the IPLPF costs are reasonably lower than the expected added value to the smooth PV power infeed.</em></strong>  </p>
<p>IPLPF costs measured from 04/2021 to 03/2022. The plane of incidence and the LPF applied are the same as in the GI(t) and GX(t) plots:<br />
<figure markdown>
  <img alt="IPLPF Costs" src="../img/IPLPF_Costs.png" width="650" />
<br />
<figcaption>Table 1</figcaption></p>
</figure>
<h4 id="conditions-of-cost-calculation">Conditions of cost calculation:</h4>
<p>CapEx of "Hybrid with BESS” system include 90% of the BESS capacity reserved for storage, 10% for smoothing.<br />
1/3 of the generated PV energy is assumed as infeed to the grid (overflow) by a "Hybrid with BESS” on-grid system.<br />
Li-Ion &amp; supercapacitor (SC): <a href="https://batteryuniversity.com/article/bu-209-how-does-a-supercapacitor-work">life cycle parameters and prices</a> are as of 2021.<br />
Hybrid supercapacitor (HSC): price has been estimated upon relation between Li-Ion and SC prices.</p>
<p>The costs are specific per 1 kW of installed PV power. Installed PV power = DC output power of PV plant (before DC/AC conversion) assuming its solar incidence 1kW/m2 (1 Sun).<br />
CapEx = initial investment to PV smoothing. OpEx = regular (e.g. yearly) costs necessary for its uninterrupted operation. The greater from (CapEx, interval * OpEx) defines the cost of PV smoothing for a given service interval. However, when the smoothing uses &gt;1 accumulation technologies concurrently, the service interval has to be fixed before calculating OpEx. (Reason: Given the service interval, two technologies with different wear-outs can be optimally mixed.) Hybrid systems and sole PV plants use different cost models, because the sole PV plant uses a mixed accumulation technology for smoothing. Energy losses due to the AC/DC conversion and accumulation were neglected.</p>
<h3 id="applications-of-iplpf">Applications of IPLPF</h3>
<h4 id="small-scale-hybrid-pv-system">Small-scale hybrid PV system</h4>
<p>A household with installed PV power &lt;10kW is connected to the low-voltage grid, having a BESS with energy capacity ≈ 2h x installed PV power. After charging the BESS to a threshold SOC (e.g. 88%), the BESS provides enough power to smooth the PV infeed (overflowing PV power) to the grid for affordable costs, provided that the remaining free BESS capacity is left for smoothing, and additional technical measures avoid the microcycling of BESS. The power intermittency of small scale PV plants has no impact on the grid, unless their concentration in the grid is high. <strong><em>IPLPF technology offers an affordable smoothing of PV power in the grid areas with high concentration of small-scale hybrid PV systems.</em></strong></p>
<h4 id="suitable-accumulators-for-iplpf">Suitable accumulators for IPLPF</h4>
<p>The measured signal GI(t) determines the specific accumulation parameters maximum specific power max|GI(τ)-GIs(τ+Δt)| [W/m2] and maximum specific energy ΔGX=max(GX)-min(GX) [Wh/m2] required for the smoothing by IPLPF method. Although IPLPF shrinks the necessary ΔGX hence ΔSOC and the total accumulated throughput to their theoretical minimum, it reciprocally increases the relative smoothing power (Pmax x 1h)/ΔSOC up to 10C, since no algorithm can supply the missing PV power while the direct Sun beams are temporarily obscured by clouds. The lithium accumulators are cheap, efficient and fast, but not enough powerful for a sole IPLPF smoothing. It is not recommended to charge/draw a Li-Ion battery by a relative power &gt;&gt; 1, otherwise the battery’s life cycle would be curtailed. Such a high relative power is provided by EDLC supercapacitors (SC), but on contrary to Lithium bateries, these do not provide enough cheap capacity to make the IPLPF smoothing affordable. The currently-available electricity accumulation technology does not harmonize with demands of the sole IPLPF smoothing.<br />
Actually, the IPLPF demands are well satisfied by a 
<a href="https://energystorage.org/why-energy-storage/technologies/flywheel-energy-storage-systems-fess/">flywheel (FESS)</a>
: 1) Its max(SOC) poses no limit to max(P) within demands of IPLPF smoothing. 2) IPLPF accumulates energy only on solar-intermittent days (else no accumulation is needed), and the flywheels only wear out when they are rotating - mainly those with mechanical bearings. Because of unknown prices and life cycle parameters, we calculated neither CapExp, nor OpExp of the flywheel in a role of IPLPF accumulator. However, <strong><em>the native synergy between demands and features identifies the flywheel as a suitable accumulator for IPLPF smoothing.</em></strong></p>
<h4 id="large-scale-pv-plant">Large-scale PV plant</h4>
<p>Water pumps provide efficient storage for large scale PV plants (cheaper and cleaner than corresponding BESS), but no power smoothing because the water pumps are too sluggish for such a role. Large-scale PV intermittency can be smoothed by a relatively low accumulation capacity =ΔSOC and a large relative power up to 10C. Such technical demands are better met by flywheels than by RedOx or EDLC technology.
Because of missing FESS prices and wear-out data, we have cost-optimized the IPLPF smoothing for a large-scale PV plant by mixing 2 technologies: SC and HSC concurrently operating during 15 years of service. The future HSC technology is already being developed: 
<a href="https://www.sciencedirect.com/science/article/abs/pii/S1364032118307299">hybrid supercapacitor</a>
, combining advantages of EDLC &amp; RedOx technologies.</p>
<h3 id="summary-of-iplpf">Summary of IPLPF</h3>
<p>One year of the continous GI(t) measurement has confirmed that ideal PV smoothing can be affordable with the current Lithium-Ion technology - if properly implemented in a hybrid PV system (incl. measures against micro-cycling of a battery). Although the HSC technology is yet unavailable, the intensive seek for energy makes it very likely to be soon mature for large-scale installations. Flywheel can be an affordable energy storage in the IPLPF smoothing of PV power. <strong><em>Low accumulated energy by the IPLPF smoothing should motivate the further development of technologies among which accurate nowcasting of PV power and smart filtering of PV power are crucial.</em></strong></p>
<h2 id="real-smoothing-of-pv-power">Real smoothing of PV power</h2>
<p>The measured global irradiance signal GI(t) allows not only the simulation of ideal predictive low-pass smoothing (IPLPF), but also the predictive smoothing of PV power (PLPF), exciting a low-pass filter (LPF) by a simulated predicted signal GIf(t+Δt). The values GIf are biased by a prediction error. As we show below, this error induces a significant accumulation of energy by PLPF when compared with IPLPF. We simulated the prediction error to the measured GI values in order to statistically represent the real predicted signal GIf(t+Δt). Based on the measured signal GI(t), the "ex-post" simulation of PLPF allowed us to empirically analyze its smoothing performance and energy accumulation.<br />
In addition to PLPF, we have developed a “smart predictive" low-pass smoothing method (patent pending SPLPF), minimizing the accumulated energy with respect to the real-predicted values GIf exciting the LPF. Finally, we analyzed the performance of four different PV smoothing methods:</p>
<ol>
<li>LPF: Input of LPF is excited by the measured signal GI(t)</li>
<li>IPLPF: Input of LPF is excited by the measured, optimally left-shifted signal GI(t+Δt)</li>
<li>PLPF: Input of LPF is excited by the simulated-predicted signal GIf(t+Δt)</li>
<li>SPLPF: Power filter is excited by the simulated-predicted signal GIf.</li>
</ol>
<h3 id="simulation-of-predicted-pv-power">Simulation of predicted PV power</h3>
<p>We simulated the predicted signal GIf(t+Δt) from the measured, left-shifted GI signal by interval Δt, by smoothing its "future" time course and by superimposing a random error to its "future" value with respect to the fundamental properties of PV predictors:</p>
<ul>
<li>as the advance Δt increases, the (unwanted) smoothing of the predicted signal GIf strengthens</li>
<li>as the advance Δt increases, the impact of  random error on GIf increases (statistically cumulates)</li>
</ul>
<p>Both errors are applied at the "future" time t+Δt whereas Δt is given by the demanded smoothing quality. Δt matches with the group delay which is controlled by the order and cut-off frequency of LPF. In the simulation, we trim the prediction error by 2 quantitative (OLAP) dimensions:</p>
<ul>
<li>Interval of prediction, after passing of which the smoothing impact on the predicted signal is strengthened, is defined by the parameter smooth_int [minute]. The shorter this interval, the steeper the smoothing effect rises towards predicted future.</li>
<li>Standard deviation of the random prediction error (dimensionless parameter SE). A random value is superimposed to future GI values. This is re-generated each time after passing a 6-minute interval of prediction. Hence the impact of random error on GIf(t+Δt) statistically cumulates over the prediction time.</li>
</ul>
<p>GI predictors with two different accuracies have been simulated:</p>
<ul>
<li>“Better prediction accuracy”: smooth_int = 6 minutes, SE = 0.05</li>
<li>"Worse prediction accuracy": smooth_int = 3 minutets, SE = 0.1.</li>
</ul>
<p>For each method, the smoothing quality and the rate of accumulation were analyzed by means of LPF orders 1 to 4. Filters of different orders are tuned to generate equivalent smoothing effects, provided that the filters of different orders are excited by the measured, optimally shifted input signal (like in IPLPF case). When this tuning rule is followed, increasing the order of the LPF increases its cutoff frequency, while the optimal advance Δt increases only slightly.<br />
Smoothing of PV power during a day with strong solar intermittency was analyzed by the four above-listed smoothing methods:
The results of analysis have been tabelized and plotted. The impact of prediction error (see Figures 2, 6) exhibits the following empiric dependencies of the tracking criteria along the OLAP partial dimensions:</p>
<h3 id="analysis-by-prediction-error">Analysis by prediction error</h3>
<h4 id="smoothed-predicted-signal">Smoothed predicted signal</h4>
<ul>
<li>Changing the value of smooth_int affects the power smoothing quality neither by SPLPF nor by PLPF method, while for all parameter values, the PLPF method is more smooth than the SPLPF method (Figures 3, 4, 7, 8).</li>
<li>Lowering the value of smooth_int dramatically increases the accumulation rate by PLPF, which is always much greater than the accumulation rate by SPLPF (Figures 5, 9). With the worse prediction accuracy, the PLPF method even exceeds the accumulation rate induced by the LPF method (Figure 9). In the SPLPF method, the accumulation rate increases only slightly and much more slowly than in PLPF.</li>
</ul>
<h4 id="random-error-in-predicted-values">Random error in predicted values</h4>
<ul>
<li>Increasing the SE parameter does not degrade the power smoothing quality by the PLPF method, but it does degrade the smoothing by SPLPF (check Figure 7 vs Figure 8). In PLPF, the smoothing quality with standard error SE &gt; 0 is always better than in SPLPF.</li>
<li>Increasing the value of SE parameter significantly increases the accumulation rate by the PLPF method (Figures 5, 9), which is for all values SE &gt; 0 much higher than by the SPLPF method. For some SE values, the PLPF method even exceeds the LPF method in its accumulation rate. The accumulation rate increases only slightly in the SPLPF method, and less so the higher the filter order.</li>
</ul>
<h3 id="analysis-by-lpf-order">Analysis by LPF order</h3>
<p>Filter order is the third OLAP dimension, impact of which on the smoothing was analyzed together with the prediction error. We analyzed the LPF orders 1 to 4 (Figures 10-21):</p>
<ul>
<li>Filter order does not affect the power smoothing by PLPF method. For small filter orders, the smoothing of PLPF is better than that of SPLPF.</li>
<li>Increasing the filter order from 1 to 3 notably improves the smoothing quality of SPLPF, given the simulated prediction error (Figures 10-12, 16-18).</li>
<li>Increasing the filter order only slightly reduces the accumulation rate by PLPF smoothing which is always substantially greater than by SPLPF.</li>
<li>Increasing the filter order from 1 to 3 notably reduces the accumulation rate by SPLPF smoothing, given the simulated prediction error (Figures 13-15, 19-21). Given the simulated predictor, the best-performing filter order is 3. <strong><em>SPLPF with the optimal filter order and with a relatively small prediction error achieves the accumulation rate close to the IPLPF method.</em></strong></li>
</ul>
<h2 id="summary">Summary</h2>
<p>Two days with strong solar intermittency have been selected for the simulation: a day with medium solar exposure 3.0 kWh/m2, and a day with high solar exposure 5.9 kWh/m2 (measured at the above-specified plane of incidence). 3rd-order low-pass filter excited with input time advance Δt = 30 minutes has been applied in order to achieve a desired smoothing impact on the PV power. Accumulation rate by four different smoothing methods has been aggregated, based on the measured signal GI(t), and the simulated predicted signal GIf(t+Δt). The results are summarized in Tables 2 and 3: In the column "ΔGX", a difference between the maximum and minimum specific accumulated energy is calculated by the expression (4). In the column "Throughput", a total daily flow of specific energy put through the accumulator is calculated by (5). The daily specific global exposure in the plane of incidence is also shown for comparison.</p>
<h3 id="accumulated-energy-by-smoothing">Accumulated energy by smoothing</h3>
<figure>
<p><img alt="IPLPF Costs" src="../img/Accu_Rate_220304.png" width="650" />
  </p>
<figcaption>Table 2</figcaption>
</figure>
<p>.  </p>
<figure>
<p><img alt="IPLPF Costs" src="../img/Accu_Rate_220404.png" width="650" />
  </p>
<figcaption>Table 3</figcaption>
</figure>
<p>With "better GI prediction accuracy", the SPLPF smoothing required 21% - 22% of the ESS energy capacity (ΔGX) used by the LPF method during the selected days, or 24% - 41% of the capacity used by the PLPF method. SPLPF eventually required 1.0 - 1.2 times the ESS capacity used by the IPLPF method. The SPLPF smoothing put 58% - 73% of the energy flow through the accumulator relative to the LPF method, or 75% - 83% of the energy throughput by the PLPF method. SPLPF eventually put 1.0 - 1.1 times more energy through ESS than the IPLPF method.</p>
<p>With "worse GI prediction accuracy", the SPLPF smoothing required 24% - 33% of the ESS energy capacity (ΔGX) used by the LPF method during the selected days, or 19% - 28% of the capacity used by the PLPF method. SPLPF eventually required 1.2 - 1.8 times the ESS capacity used by the IPLPF method. The SPLPF method put 59% - 77% of the daily energy flow through the accumulator relative to the LPF method, or 63% - 69% of the energy throughput by the PLPF method. SPLPF eventually put 1.0 - 1.1 times more  energy through ESS than the IPLPF method.</p>
<p>Although we haven't analyzed the whole year (the numerical simulation is computationally intensive), the analysis of 4 smoothing methods based on 2 days with high solar intermittency, different solar exposures, with various filter orders and prediction errors gave the real assumption that SPLPF performs much better than PLPF, and provided that the prediction error is relatively low, <strong><em>SPLPF with the optimal filter order performs close to the ideal smoothing IPLPF.</em></strong> These empiric results were also theoretically justified.</p>
<h2 id="graphical-display-of-smoothing">Graphical display of smoothing</h2>
<p>Following graphs illustrate the smoothing quality by the prediction accuracy and smoothing method, and the minimizing of accumulated energy by the filter order. The measured PV data from 2 selected days have been processed and plotted as the following per-day time courses:</p>
<ul>
<li>Measured GI(t), synchronized with predicted GIf (1 hour zoomed) - Figures 2, 6</li>
<li>Measured GI(t) and its smooth counterpart by the prediction accuracy and smoothing method, applying the optimal LPF order - Figures 3, 4, 7, 8</li>
<li>Accumulated GX(t) by the prediction accuracy and smoothing method, applying the optimal LPF order - Figures 5, 9</li>
<li>Smoothed GI(t) by the filter order and prediction accuracy, using the IPLPF and SPLPF smoothing methods - Figures 10-12, 16-18</li>
<li>Accumulated GX by the filter order and prediction accuracy, using the IPLPF and SPLPF smoothing methods - Figures 13-15, 19-21</li>
</ul>
<h3 id="analysis-by-prediction-error_1">Analysis by prediction error</h3>
<h4 id="day-with-medium-insolation">Day with medium insolation</h4>
<figure>
<p><img alt="GIf_220304" src="../img/2022-03-04_from11h_to12h.png" width="650" />
  </p>
<figcaption>Figure 2: Measured GI synchronized with GIf (predicted 30 minutes ago) between 11:00 and 12:00. (Lo Err: better prediction accuracy, Hi Err: worse prediction accuracy)</figcaption>
</figure>
<figure>
<p><img alt="GIs_LoErr_220304" src="../img/se0.05_6min_2022-03-04.png" width="650" />
  </p>
<figcaption>Figure 3: Measured and smoothed GI by 4 different methods; better prediction accuracy</figcaption>
</figure>
<figure>
<p><img alt="GIs_HiErr_220304" src="../img/se0.1_3min_2022-03-04.png" width="650" />
  </p>
<figcaption>Figure 4: Measured and smoothed GI by 4 smoothing methods; worse prediction accuracy</figcaption>
</figure>
<figure>
<p><img alt="GX_220304" src="../img/sim24_2022-03-04.png" width="650" />
  </p>
<figcaption>Figure 5: Time course of GX accumulated by 4 smoothing methods. (Lo Err: better prediction accuracy, Hi Err: worse prediction accuracy)</figcaption>
</figure>
<h4 id="day-with-high-insolation">Day with high insolation</h4>
<figure>
<p><img alt="GIf_220404" src="../img/2022-04-04_from11h_to12h.png" width="650" />
  </p>
<figcaption>Figure 6: Measured GI synchronized with GIf (predicted 30 minutes ago) between 11:00 and 12:00. (Lo Err: better prediction accuracy, Hi Err: worse prediction accuracy)</figcaption>
</figure>
<figure>
<p><img alt="GIs_LoErr_220404" src="../img/se0.05_6min_2022-04-04.png" width="650" />
  </p>
<figcaption>Figure 7: Measured and smoothed GI by 4 smoothing methods; better prediction accuracy</figcaption>
</figure>
<figure>
<p><img alt="GIs_HiErr_220404" src="../img/se0.1_3min_2022-04-04.png" width="650" />
  </p>
<figcaption>Figure 8: Measured and smoothed GI by 4 smoothing methods; worse prediction accuracy</figcaption>
</figure>
<figure>
<p><img alt="GX_220404" src="../img/sim24_2022-04-04.png" width="650" />
  </p>
<figcaption>Figure 9: Time course of GX accumulated by 4 smoothing methods. (Lo Err: better prediction accuracy, Hi Err: worse prediction accuracy)</figcaption>
</figure>
<h3 id="analysis-by-lpf-order_1">Analysis by LPF order</h3>
<h4 id="day-with-medium-insolation_1">Day with medium insolation</h4>
<figure>
<p><img alt="GIs_aavg0_220304" src="../img/order_gi_aavg0_2022-03-04.png" width="650" />
  </p>
<figcaption>Figure 10: Time course of IPLPF-smoothed GI by filter order</figcaption>
</figure>
<figure>
<p><img alt="GIs_LoErr_220304" src="../img/order_gi_plp7_2022-03-04.png" width="650" />
  </p>
<figcaption>Figure 11: Time course of SPLPF-smoothed GI by filter order; better prediction accuracy</figcaption>
</figure>
<figure>
<p><img alt="GIs_HiErr_220304" src="../img/order_gi_plp13_2022-03-04.png" width="650" />
  </p>
<figcaption>Figure 12: Time course of SPLPF-smoothed GI by filter order; worse prediction accuracy</figcaption>
</figure>
<figure>
<p><img alt="GX_aavg0_220304" src="../img/order_gx_aavg0_2022-03-04.png" width="650" />
  </p>
<figcaption>Figure 13: Time course of IPLPF-accumulated GX by filter order</figcaption>
</figure>
<figure>
<p><img alt="GX_LoErr_220304" src="../img/order_gx_plp7_2022-03-04.png" width="650" />
  </p>
<figcaption>Figure 14: Time course of SPLPF-accumulated GX by filter order; better prediction accuracy</figcaption>
</figure>
<figure>
<p><img alt="GX_HiErr_220304" src="../img/order_gx_plp13_2022-03-04.png" width="650" />
  </p>
<figcaption>Figure 15: Time course of SPLPF-accumulated GX by filter order; worse prediction accuracy</figcaption>
</figure>
<p>.  </p>
<h4 id="day-with-high-insolation_1">Day with high insolation</h4>
<figure>
<p><img alt="GIs_aavg0_220404" src="../img/order_gi_aavg0_2022-04-04.png" width="650" />
  </p>
<figcaption>Figure 16: Time course of IPLPF-smoothed GI by filter order</figcaption>
</figure>
<figure>
<p><img alt="GIs_LoErr_220404" src="../img/order_gi_plp7_2022-04-04.png" width="650" />
  </p>
<figcaption>Figure 17: Time course of SPLPF-smoothed GI by filter order; better prediction accuracy</figcaption>
</figure>
<figure>
<p><img alt="GIs_HiErr_220404" src="../img/order_gi_plp13_2022-04-04.png" width="650" />
  </p>
<figcaption>Figure 18: Time course of SPLPF-smoothed GI by filter order; worse prediction accuracy</figcaption>
</figure>
<figure>
<p><img alt="GX_aavg0_220404" src="../img/order_gx_aavg0_2022-04-04.png" width="650" />
  </p>
<figcaption>Figure 19 Time course of IPLPF-accumulated GX by filter order)</figcaption>
</figure>
<figure>
<p><img alt="GX_LoErr_220404" src="../img/order_gx_plp7_2022-04-04.png" width="650" />
  </p>
<figcaption>Figure 20: Time course of SPLPF-accumulated GX by filter order; better prediction accuracy</figcaption>
</figure>
<figure>
<p><img alt="GX_HiErr_220404" src="../img/order_gx_plp13_2022-04-04.png" width="650" />
  </p>
<figcaption>Figure 21: Time course of SPLPF-accumulated GX by filter order; worse prediction accuracy</figcaption>
</figure>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../pv_log/" class="btn btn-neutral float-left" title="Photovoltaic intermitency"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../v_glossary/" class="btn btn-neutral float-right" title="Glossary">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../pv_log/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../v_glossary/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>  
    
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>
    <script async src="//static.getclicky.com/101403225.js"></script>
    <noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/101403225ns.gif" /></p></noscript>


</body>
</html>
